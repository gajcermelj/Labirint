var canvas = document.getElementById('canvas');
var ctx = canvas.getContext('2d');

var x = 12; 
var y = 12;
var velikost = 10;

var mazePathX1=[2, 242, 18, 82, 130, 178, 242, 434, 50, 114, 194, 226, 274, 306, 338, 386, 434, 18, 98, 162, 242, 274, 322, 354, 386, 450, 18, 98, 146, 178, 226, 258, 290, 354, 434, 2, 34, 66, 210, 258, 402, 450, 50, 226, 274, 322, 354, 418, 18, 66, 114, 178, 226, 386, 418, 450, 34, 114, 226, 274, 322, 386, 434, 18, 66, 98, 130, 162, 210, 242, 274, 354, 466, 2, 34, 98, 162, 194, 242, 290, 322, 354, 386, 418, 450, 18, 50, 114, 162, 242, 338, 386, 434, 34, 82, 130, 210, 258, 354, 402, 2, 66, 178, 210, 258, 338, 386, 418, 450, 34, 82, 130, 178, 322, 386, 434, 466, 50, 98, 178, 242, 306, 370, 434, 34, 66, 178, 226, 258, 290, 354, 386, 418, 466, 18, 82, 130, 162, 194, 226, 274, 338, 386, 450, 34, 98, 210, 242, 322, 354, 402, 2, 82, 162, 194, 306, 354, 386, 418, 450, 2, 34, 98, 130, 178, 210, 258, 306, 370, 402, 2, 114, 258, 290, 338, 386, 434, 18, 82, 162, 226, 258, 322, 386, 418, 2, 66, 130, 178, 274, 322, 434, 466, 18, 114, 162, 226, 338, 402, 434, 2, 98, 162, 210, 306, 370, 418, 450, 18, 82, 114, 178, 274, 322, 450, 50, 162, 194, 258, 354, 418, 82, 146, 226, 290, 354, 418, 466, 2, 50, 98, 130, 194, 226, 290, 370, 402, 434, 2, 258, 2, 18, 18, 18, 18, 18, 34, 34, 34, 34, 34, 34, 34, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 66, 66, 66, 66, 66, 66, 82, 82, 82, 82, 82, 82, 82, 98, 98, 98, 98, 98, 98, 98, 98, 114, 114, 114, 114, 114, 114, 114, 114, 114, 130, 130, 130, 130, 130, 130, 130, 146, 146, 146, 146, 146, 146, 162, 162, 162, 162, 162, 162, 178, 178, 178, 178, 178, 178, 178, 178, 178, 194, 194, 194, 194, 194, 194, 194, 194, 210, 210, 210, 210, 210, 210, 210, 210, 226, 226, 226, 226, 226, 226, 226, 226, 242, 242, 242, 242, 242, 242, 242, 258, 258, 258, 258, 258, 258, 258, 258, 258, 274, 274, 274, 274, 274, 274, 274, 274, 274, 290, 290, 290, 290, 290, 290, 306, 306, 306, 306, 306, 306, 306, 306, 322, 322, 322, 322, 322, 322, 322, 322, 338, 338, 338, 338, 338, 338, 338, 338, 338, 354, 354, 354, 354, 354, 354, 354, 370, 370, 370, 370, 370, 370, 370, 370, 386, 386, 386, 386, 386, 386, 386, 402, 402, 402, 402, 402, 402, 418, 418, 418, 418, 418, 418, 418, 418, 434, 434, 434, 434, 434, 434, 434, 450, 450, 450, 450, 450, 466, 466, 466, 466, 466, 466, 482];	
var mazePathX2=[226, 482, 34, 114, 146, 210, 338, 466, 98, 162, 210, 258, 290, 322, 370, 418, 482, 66, 146, 194, 258, 290, 338, 370, 418, 466, 34, 114, 162, 194, 242, 274, 306, 418, 482, 18, 50, 98, 226, 386, 418, 466, 146, 258, 290, 338, 386, 466, 34, 98, 162, 210, 290, 402, 434, 466, 82, 146, 242, 306, 354, 402, 450, 50, 82, 114, 146, 194, 226, 258, 338, 386, 482, 18, 50, 146, 178, 210, 274, 306, 338, 370, 402, 434, 466, 34, 66, 130, 226, 306, 354, 402, 466, 50, 114, 178, 226, 306, 386, 434, 18, 114, 194, 242, 322, 370, 402, 434, 466, 50, 98, 162, 194, 338, 402, 450, 482, 66, 114, 226, 290, 354, 402, 466, 50, 98, 210, 242, 274, 306, 370, 402, 434, 482, 66, 98, 146, 178, 210, 258, 290, 354, 418, 466, 66, 162, 226, 306, 338, 370, 466, 50, 146, 178, 210, 322, 370, 402, 434, 466, 18, 82, 114, 146, 194, 226, 274, 322, 386, 482, 18, 146, 274, 322, 370, 402, 466, 50, 130, 178, 242, 290, 370, 402, 466, 18, 114, 162, 226, 306, 402, 450, 482, 50, 130, 194, 258, 370, 418, 482, 34, 114, 194, 274, 322, 386, 434, 466, 34, 98, 146, 210, 306, 402, 466, 114, 178, 242, 338, 370, 434, 114, 194, 258, 306, 386, 434, 482, 34, 82, 114, 162, 210, 258, 338, 386, 418, 466, 242, 482, 2, 18, 18, 18, 18, 18, 34, 34, 34, 34, 34, 34, 34, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 66, 66, 66, 66, 66, 66, 82, 82, 82, 82, 82, 82, 82, 98, 98, 98, 98, 98, 98, 98, 98, 114, 114, 114, 114, 114, 114, 114, 114, 114, 130, 130, 130, 130, 130, 130, 130, 146, 146, 146, 146, 146, 146, 162, 162, 162, 162, 162, 162, 178, 178, 178, 178, 178, 178, 178, 178, 178, 194, 194, 194, 194, 194, 194, 194, 194, 210, 210, 210, 210, 210, 210, 210, 210, 226, 226, 226, 226, 226, 226, 226, 226, 242, 242, 242, 242, 242, 242, 242, 258, 258, 258, 258, 258, 258, 258, 258, 258, 274, 274, 274, 274, 274, 274, 274, 274, 274, 290, 290, 290, 290, 290, 290, 306, 306, 306, 306, 306, 306, 306, 306, 322, 322, 322, 322, 322, 322, 322, 322, 338, 338, 338, 338, 338, 338, 338, 338, 338, 354, 354, 354, 354, 354, 354, 354, 370, 370, 370, 370, 370, 370, 370, 370, 386, 386, 386, 386, 386, 386, 386, 402, 402, 402, 402, 402, 402, 418, 418, 418, 418, 418, 418, 418, 418, 434, 434, 434, 434, 434, 434, 434, 450, 450, 450, 450, 450, 466, 466, 466, 466, 466, 466, 482];
var mazePathY1=[2, 2, 18, 18, 18, 18, 18, 18, 34, 34, 34, 34, 34, 34, 34, 34, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 66, 66, 66, 66, 66, 66, 66, 66, 66, 82, 82, 82, 82, 82, 82, 82, 98, 98, 98, 98, 98, 98, 114, 114, 114, 114, 114, 114, 114, 114, 130, 130, 130, 130, 130, 130, 130, 146, 146, 146, 146, 146, 146, 146, 146, 146, 146, 162, 162, 162, 162, 162, 162, 162, 162, 162, 162, 162, 162, 178, 178, 178, 178, 178, 178, 178, 178, 194, 194, 194, 194, 194, 194, 194, 210, 210, 210, 210, 210, 210, 210, 210, 210, 226, 226, 226, 226, 226, 226, 226, 226, 242, 242, 242, 242, 242, 242, 242, 258, 258, 258, 258, 258, 258, 258, 258, 258, 258, 274, 274, 274, 274, 274, 274, 274, 274, 274, 274, 290, 290, 290, 290, 290, 290, 290, 306, 306, 306, 306, 306, 306, 306, 306, 306, 322, 322, 322, 322, 322, 322, 322, 322, 322, 322, 338, 338, 338, 338, 338, 338, 338, 354, 354, 354, 354, 354, 354, 354, 354, 370, 370, 370, 370, 370, 370, 370, 370, 386, 386, 386, 386, 386, 386, 386, 402, 402, 402, 402, 402, 402, 402, 402, 418, 418, 418, 418, 418, 418, 418, 434, 434, 434, 434, 434, 434, 450, 450, 450, 450, 450, 450, 450, 466, 466, 466, 466, 466, 466, 466, 466, 466, 466, 482, 482, 2, 34, 82, 162, 194, 418, 2, 82, 130, 178, 242, 290, 338, 434, 18, 114, 162, 210, 258, 338, 370, 402, 450, 2, 50, 98, 178, 306, 450, 34, 146, 226, 290, 338, 386, 466, 130, 178, 226, 274, 306, 338, 370, 466, 2, 50, 114, 178, 258, 322, 354, 402, 450, 50, 162, 210, 242, 338, 370, 434, 18, 66, 130, 194, 322, 370, 2, 34, 210, 306, 370, 402, 18, 66, 114, 194, 226, 290, 354, 418, 450, 66, 130, 178, 210, 242, 306, 354, 434, 18, 114, 194, 274, 322, 370, 402, 434, 2, 50, 114, 146, 226, 306, 386, 450, 66, 162, 194, 258, 290, 354, 418, 34, 82, 114, 178, 226, 274, 322, 402, 466, 18, 50, 98, 130, 226, 258, 290, 386, 434, 34, 210, 242, 274, 322, 370, 34, 82, 114, 146, 194, 274, 354, 450, 18, 98, 178, 258, 338, 370, 402, 450, 2, 66, 98, 162, 194, 242, 370, 434, 466, 18, 98, 226, 274, 322, 386, 434, 2, 50, 82, 162, 242, 290, 322, 402, 18, 50, 146, 242, 386, 434, 466, 2, 66, 178, 322, 354, 402, 2, 114, 194, 242, 290, 322, 386, 434, 18, 66, 130, 210, 258, 338, 402, 130, 194, 258, 354, 418, 34, 66, 98, 194, 386, 434, 2];
var mazePathY2=[2, 2, 18, 18, 18, 18, 18, 18, 34, 34, 34, 34, 34, 34, 34, 34, 34, 50, 50, 50, 50, 50, 50, 50, 50, 50, 66, 66, 66, 66, 66, 66, 66, 66, 66, 82, 82, 82, 82, 82, 82, 82, 98, 98, 98, 98, 98, 98, 114, 114, 114, 114, 114, 114, 114, 114, 130, 130, 130, 130, 130, 130, 130, 146, 146, 146, 146, 146, 146, 146, 146, 146, 146, 162, 162, 162, 162, 162, 162, 162, 162, 162, 162, 162, 162, 178, 178, 178, 178, 178, 178, 178, 178, 194, 194, 194, 194, 194, 194, 194, 210, 210, 210, 210, 210, 210, 210, 210, 210, 226, 226, 226, 226, 226, 226, 226, 226, 242, 242, 242, 242, 242, 242, 242, 258, 258, 258, 258, 258, 258, 258, 258, 258, 258, 274, 274, 274, 274, 274, 274, 274, 274, 274, 274, 290, 290, 290, 290, 290, 290, 290, 306, 306, 306, 306, 306, 306, 306, 306, 306, 322, 322, 322, 322, 322, 322, 322, 322, 322, 322, 338, 338, 338, 338, 338, 338, 338, 354, 354, 354, 354, 354, 354, 354, 354, 370, 370, 370, 370, 370, 370, 370, 370, 386, 386, 386, 386, 386, 386, 386, 402, 402, 402, 402, 402, 402, 402, 402, 418, 418, 418, 418, 418, 418, 418, 434, 434, 434, 434, 434, 434, 450, 450, 450, 450, 450, 450, 450, 466, 466, 466, 466, 466, 466, 466, 466, 466, 466, 482, 482, 482, 66, 130, 178, 290, 450, 34, 98, 146, 210, 258, 306, 418, 466, 82, 130, 178, 242, 274, 354, 386, 434, 466, 34, 66, 162, 258, 434, 466, 82, 178, 242, 306, 354, 434, 482, 146, 194, 242, 290, 322, 354, 386, 482, 18, 82, 146, 242, 290, 338, 370, 434, 466, 98, 178, 226, 274, 354, 402, 466, 34, 98, 178, 274, 354, 466, 18, 162, 290, 354, 386, 434, 50, 98, 130, 210, 242, 338, 386, 434, 466, 114, 162, 194, 226, 290, 338, 370, 450, 98, 162, 226, 306, 354, 386, 418, 482, 18, 98, 130, 178, 258, 354, 418, 466, 82, 178, 242, 274, 338, 386, 434, 66, 98, 162, 194, 258, 306, 370, 450, 482, 34, 66, 114, 162, 242, 274, 322, 402, 466, 50, 226, 258, 306, 354, 434, 66, 98, 130, 162, 242, 322, 402, 466, 66, 130, 210, 290, 354, 386, 418, 466, 18, 82, 114, 178, 226, 338, 402, 450, 482, 50, 178, 242, 290, 370, 402, 466, 18, 66, 130, 226, 274, 306, 338, 434, 34, 66, 178, 322, 402, 450, 482, 18, 162, 226, 338, 386, 450, 34, 178, 226, 274, 306, 370, 418, 466, 50, 82, 194, 242, 290, 354, 434, 162, 226, 306, 370, 466, 50, 82, 146, 226, 418, 450, 482];

function draw(){
	ctx.strokeStyle = "black";
    ctx.lineWidth = 2;
    for (var i = 0; i < mazePathX1.length; i++) {
        ctx.beginPath();
        ctx.moveTo(mazePathX1[i], mazePathY1[i]);
        ctx.lineTo(mazePathX2[i], mazePathY2[i]);
        ctx.stroke();
    }
}

// Funkcija za risanje igralca
function drawPlayer() {
    ctx.fillStyle = "red";
    ctx.fillRect(x, y, velikost, velikost);
}

// Preverjanje kolizije s črno barvo (zidovi)
function canMove(newX, newY) {
    // Preverimo 4 točke okoli kvadrata, da vidimo če zadene zid
    var points = [
        [newX, newY],
        [newX + velikost, newY],
        [newX, newY + velikost],
        [newX + velikost, newY + velikost]
    ];
    for (var p of points) {
        var pixel = ctx.getImageData(p[0], p[1], 1, 1).data;
        if (pixel[0] === 0 && pixel[1] === 0 && pixel[2] === 0) {
            return false;
        }
    }
    return true;
}
window.addEventListener('keydown', function(e) {
    var step = 4;
    var nextX = x;
    var nextY = y;

    if (e.key === "ArrowUp") nextY -= step;
    if (e.key === "ArrowDown") nextY += step;
    if (e.key === "ArrowLeft") nextX -= step;
    if (e.key === "ArrowRight") nextX += step;

    if (canMove(nextX, nextY)) {
        x = nextX;
        y = nextY;
    }
});
function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    draw();
    drawPlayer();
    requestAnimationFrame(update);
}
update();